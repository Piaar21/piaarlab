<!-- templates/return_process/base.html -->
<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>PIAARLAB ë°˜í’ˆ í”„ë¡œì„¸ìŠ¤</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
  />

  <style>

    .navbar-tabs {
      position: fixed;
      bottom: 0;
      width: 100%;
      background-color: #f8f9fa;
      border-top: 1px solid #dee2e6;
    }
    .navbar-tabs .nav-item {
      flex: 1;
      text-align: center;
    }
    .navbar-tabs .nav-link {
      padding: 10px;
    }
    body {
      margin-bottom: 60px; 
    }
    */


    body {
      /* ë§Œì•½ í•˜ë‹¨ íƒ­ì„ ì•ˆ ì“°ì‹œë©´ margin-bottom ì œê±°í•´ë„ ë©ë‹ˆë‹¤. */
      margin: 0;
      font-family: sans-serif;
      background-color: #f7fafc;
    }

    .sidebar-container {
      position: relative;
    }

    /* ì‚¬ì´ë“œë°” */
    .sidebar-custom {
      position: fixed;
      top: 0;
      left: 0;
      width: 16rem; /* tailwind w-64 ì •ë„ */
      height: 100vh;
      background-color: #2d3748; /* ì§™ì€ íšŒìƒ‰(bg-gray-800 ìœ ì‚¬) */
      transform: translateX(0);
      transition: transform 0.3s ease-in-out;
      z-index: 1040;
      overflow-y: auto;
      padding: 1rem;
      color: #fff;
    }
    .sidebar-custom.closed {
      transform: translateX(-100%);
    }

    .sidebar-custom .sidebar-content {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    /* ë‹«ê¸° ë²„íŠ¼ */
    .sidebar-close-btn {
      align-self: flex-end;
      background: transparent;
      border: none;
      cursor: pointer;
      color: #a0aec0; /* ë°ì€ íšŒìƒ‰ */
      margin-bottom: 1rem;
      font-size: 1rem;
    }
    .sidebar-close-btn:hover {
      color: #fff;
    }

    /* ìƒìœ„ ë©”ë‰´ ë¦¬ìŠ¤íŠ¸ */
    .sidebar-nav-list {
      list-style: none;
      padding-left: 0;
    }
    .sidebar-nav-list > li {
      margin-bottom: 0.5rem;
    }

    /* ìƒìœ„ ë©”ë‰´ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .sidebar-nav-item {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: transparent;
      border: none;
      padding: 0.5rem 0.75rem;
      color: #fff;
      cursor: pointer;
      font-size: 1rem;
      text-align: left;
      border-radius: 0.375rem; /* ì˜ˆ: rounded-lg */
    }
    .sidebar-nav-item:hover {
      background-color: #4a5568; /* hover:bg-gray-700 */
    }

    /* ì•„ì´ì½˜ + ë¼ë²¨ ì˜ì—­ */
    .sidebar-nav-item-group {
      display: flex;
      align-items: center;
    }
    .sidebar-nav-item-group .icon {
      display: inline-flex;
      margin-right: 0.75rem;
      font-weight: bold;
    }

    /* ì„œë¸Œë©”ë‰´ UL */
    .sidebar-sub-list {
      list-style: none;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, opacity 0.3s ease;
      opacity: 0;
      margin-left: 2.5rem;
      padding-left: 0;
    }
    .sidebar-sub-list.open {
      max-height: 20rem; /* ì¶©ë¶„íˆ í° ê°’ (ì„œë¸Œë§í¬ ê°œìˆ˜ì— ë§ê²Œ ì¡°ì ˆ) */
      opacity: 1;
    }

    .sidebar-sub-list li a {
      display: block;
      padding: 0.5rem 0;
      color: #a0aec0; /* ì¡°ê¸ˆ ë°ì€ íšŒìƒ‰ */
      font-size: 0.875rem;
      text-decoration: none;
      border-radius: 0.375rem;
    }
    .sidebar-sub-list li a:hover {
      background-color: #4a5568;
      color: #fff;
    }

    /* ì²´ë¸Œë¡  ì•„ì´ì½˜ íšŒì „ */
    .chevron {
      display: inline-block;
      transition: transform 0.3s ease;
    }
    .chevron.rotated {
      transform: rotate(180deg);
    }

    /* ì‚¬ì´ë“œë°” ì—´ê¸° ë²„íŠ¼ */
    .sidebar-open-btn {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1050;
      background-color: #2d3748;
      color: #fff;
      border: none;
      padding: 0.5rem;
      cursor: pointer;
      border-radius: 0.375rem;
      transition: opacity 0.3s ease;
    }
    .sidebar-open-btn.hidden {
      opacity: 0;
      pointer-events: none;
    }
  </style>
</head>

<body>
  <div class="sidebar-container">
    <!-- ì ‘ì´ì‹ ì‚¬ì´ë“œë°” -->
    <aside class="sidebar-custom" id="sidebar">
      <div class="sidebar-content">
        <!-- ë‹«ê¸° ë²„íŠ¼ -->
        <button class="sidebar-close-btn" id="closeSidebarBtn">X</button>

        <!-- ìƒìœ„ ë©”ë‰´ ëª©ë¡: 4ê°œì˜ ë©”ì¸ ë©”ë‰´ -->
        <ul class="sidebar-nav-list">
          <!-- (1) ë°˜í’ˆí”„ë¡œì„¸ìŠ¤ -->
          <li>
            <button class="sidebar-nav-item" data-index="0">
              <div class="sidebar-nav-item-group">
                <span class="icon">ğŸ“¦</span>
                <span class="label">ë°˜í’ˆí”„ë¡œì„¸ìŠ¤</span>
              </div>
              <span class="chevron">â¬‡</span>
            </button>
            <ul class="sidebar-sub-list open" data-sub="0">
              <li><a href="{% url 'return_dashboard' %}">ëŒ€ì‹œë³´ë“œ</a></li>
              <li><a href="{% url 'ë°˜í’ˆëª©ë¡' %}">ë°˜í’ˆëª©ë¡</a></li>
              <li><a href="{% url 'ìŠ¤ìº”' %}">ìŠ¤ìº”</a></li>
              <li><a href="{% url 'ìˆ˜ê±°ì™„ë£Œ' %}">ìˆ˜ê±°ì™„ë£Œ</a></li>
              <li><a href="{% url 'ê²€ìˆ˜ì™„ë£Œ' %}">ê²€ìˆ˜ì™„ë£Œ</a></li>
              <li><a href="{% url 'ë°˜í’ˆì™„ë£Œ' %}">ë°˜í’ˆì™„ë£Œ</a></li>
              <li><a href="{% url 'ì¬ê³ ë°˜ì˜ì™„ë£Œ' %}">ì¬ê³ ë°˜ì˜</a></li>
              <li><a href="{% url 'ì²˜ë¦¬ì™„ë£Œ' %}">ì²˜ë¦¬ì™„ë£Œ</a></li>
            </ul>
          </li>

          <!-- (2) ë°°ì†¡ì§€ì—°ê´€ë¦¬ -->
          <li>
            <button class="sidebar-nav-item open" data-index="1">
              <div class="sidebar-nav-item-group">
                <span class="icon">â°</span>
                <span class="label">ë°°ì†¡ì§€ì—°ê´€ë¦¬</span>
              </div>
              <span class="chevron">â¬‡</span>
            </button>
            <ul class="sidebar-sub-list open" data-sub="1">
              <li><a href="{% url 'upload_delayed_orders' %}">ì—…ë¡œë“œ</a></li>
              <li><a href="{% url 'delayed_shipment_list' %}">ë¦¬ìŠ¤íŠ¸</a></li>
              <li><a href="{% url 'send_message_list' %}">ë°œì†¡ì™„ë£Œ</a></li>
              <li><a href="{% url 'confirmed_list' %}">í™•ì¸ì™„ë£Œ</a></li>
              <li><a href="{% url 'shipped_list' %}">ì¶œê³ ì™„ë£Œ</a></li>
              <li><a href="{% url 'upload_store_mapping' %}">ìŠ¤í† ì–´ëª…</a></li>
              <li><a href="{% url 'restock_management' %}">ì¬ì…ê³ ì¼ì</a></li>
              <li><a href="{% url 'out_of_stock_management' %}">í’ˆì ˆê´€ë¦¬</a></li>
            </ul>
          </li>

          <!-- (3) í†µí•©CSê´€ë¦¬ -->
          <li>
            <button class="sidebar-nav-item" data-index="2">
              <div class="sidebar-nav-item-group">
                <span class="icon">â˜ï¸</span>
                <span class="label">í†µí•©CSê´€ë¦¬</span>
              </div>
              <span class="chevron">â¬‡</span>
            </button>
            <ul class="sidebar-sub-list open" data-sub="2">
              <!-- ì•„ë˜ëŠ” ì˜ˆì‹œë¡œ "ê³ ê°ë¬¸ì˜"ë§Œ ì¶”ê°€. í•„ìš”í•œ ë§í¬ê°€ ë” ìˆë‹¤ë©´ ì¶”ê°€í•˜ì„¸ìš”. -->
              <li><a href="{% url 'cs_management:inquiry_product_list' %}">ê³ ê°ë¬¸ì˜</a></li>
              <li><a href="{% url 'cs_management:inquiry_center_list' %}">ê³ ê°ì„¼í„°ë¬¸ì˜</a></li>
            </ul>
          </li>

          <!-- (4) ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ -->
          <li>
            <button class="sidebar-nav-item" data-index="3">
              <div class="sidebar-nav-item-group">
                <span class="icon">ğŸ”‘</span>
                <span class="label">ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ</span>
              </div>
              <span class="chevron">â¬‡</span>
            </button>
            <ul class="sidebar-sub-list" data-sub="3">
              {% if user.is_authenticated %}
              <li>
                <form
                  action="{% url 'logout' %}"
                  method="post"
                  class="d-inline"
                  style="margin: 0; padding: 0;"
                >
                  {% csrf_token %}
                  <!-- ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ í›„ ì´ë™í•  next íŒŒë¼ë¯¸í„° í•„ìš” ì‹œ -->
                  <input type="hidden" name="next" value="{% url 'login' %}" />
                  <button
                    type="submit"
                    style="
                      border: none;
                      background: none;
                      color: #a0aec0;
                      cursor: pointer;
                      padding: 0.5rem 0;
                    "
                  >
                    ë¡œê·¸ì•„ì›ƒ
                  </button>
                </form>
              </li>
              {% else %}
              <li><a href="{% url 'login' %}">ë¡œê·¸ì¸</a></li>
              <li><a href="{% url 'signup' %}">íšŒì›ê°€ì…</a></li>
              {% endif %}
            </ul>
          </li>
        </ul>
      </div>
    </aside>

    <!-- ì‚¬ì´ë“œë°” ì—´ê¸° ë²„íŠ¼ -->
    <button class="sidebar-open-btn hidden" id="openSidebarBtn">ë©”ë‰´</button>
  </div>

  <!-- Django í…œí”Œë¦¿ ë¸”ë¡ -->
  {% block content %}
  {% endblock %}

  <!-- ê¸°ì¡´ í•˜ë‹¨ íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
  <nav class="navbar-tabs">
    <ul class="nav nav-tabs justify-content-center">
      <li class="nav-item">
        <a class="nav-link" href="{% url 'return_dashboard' %}">ëŒ€ì‹œë³´ë“œ</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ë°˜í’ˆëª©ë¡' %}">ë°˜í’ˆëª©ë¡</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ìŠ¤ìº”' %}">ìŠ¤ìº”</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ìˆ˜ê±°ì™„ë£Œ' %}">ìˆ˜ê±°ì™„ë£Œ</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ê²€ìˆ˜ì™„ë£Œ' %}">ê²€ìˆ˜ì™„ë£Œ</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ë°˜í’ˆì™„ë£Œ' %}">ë°˜í’ˆì™„ë£Œ</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ì¬ê³ ë°˜ì˜ì™„ë£Œ' %}">ì¬ê³ ë°˜ì˜</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{% url 'ì²˜ë¦¬ì™„ë£Œ' %}">ì²˜ë¦¬ì™„ë£Œ</a>
      </li>
    </ul>
  </nav>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
    integrity="sha384-7/xqA5FEhpzZVnTPl70bgc44dmX4Wo0cDw9dJ2Sa4zPw6gZ/O/mOJb0DKaMr3Z5F"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"
  ></script>

  <!-- ì ‘ì´ì‹ ì‚¬ì´ë“œë°” ë™ì‘ ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    const openSidebarBtn = document.getElementById("openSidebarBtn");
    const closeSidebarBtn = document.getElementById("closeSidebarBtn");
    const sidebar = document.getElementById("sidebar");
    const navItems = document.querySelectorAll(".sidebar-nav-item");

    // í˜„ì¬ ì—´ë ¤ìˆëŠ” ì„œë¸Œë©”ë‰´ ì¸ë±ìŠ¤ ì €ì¥
    let openItems = [];

    // ì‚¬ì´ë“œë°” ì—´ê¸°
    openSidebarBtn.addEventListener("click", () => {
      sidebar.classList.remove("closed");
      openSidebarBtn.classList.add("hidden");
    });

    // ì‚¬ì´ë“œë°” ë‹«ê¸°
    closeSidebarBtn.addEventListener("click", () => {
      sidebar.classList.add("closed");
      openSidebarBtn.classList.remove("hidden");
    });

    // ìƒìœ„ ë©”ë‰´ í´ë¦­ ì‹œ ì„œë¸Œë©”ë‰´ ì—´ê¸°/ë‹«ê¸°
    navItems.forEach((item) => {
      item.addEventListener("click", () => {
        const index = item.dataset.index;
        // ì´ë¯¸ ì—´ë ¤ìˆìœ¼ë©´ ë‹«ê³ , ë‹«í˜€ìˆìœ¼ë©´ ì—´ê¸°
        if (openItems.includes(index)) {
          openItems = openItems.filter((i) => i !== index);
        } else {
          openItems.push(index);
        }
        // í•´ë‹¹ ì¸ë±ìŠ¤ì˜ ì„œë¸Œë©”ë‰´ ì°¾ê¸°
        const subList = document.querySelector(
          `.sidebar-sub-list[data-sub="${index}"]`
        );
        if (subList) {
          subList.classList.toggle("open");
        }
        // ì²´ë¸Œë¡  íšŒì „
        const chevron = item.querySelector(".chevron");
        chevron.classList.toggle("rotated");
      });
    });
  </script>
</body>
</html>